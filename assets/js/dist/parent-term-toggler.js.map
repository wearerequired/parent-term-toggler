{"version":3,"sources":["../src/parent-term-toggler.js"],"names":["window","$","jQuery","ParentTermToggler","taxonomy","$metabox","event","$el","currentTarget","termIsChild","stopWatch","isChecked","is","traverseParentTermsAndSetChecked","find","eq","trigger","watch","checked","parents","each","index","element","$term","parent","prop","closest","length","on","toggle","bind","off","_ParentTermTogglerSettings","supportedTaxonomies","forEach","toggler"],"mappings":";;;;;;AAAA;;cAEsBA,M;IAANC,C,WAARC,M;;IAEFC,iB;AACL;;;;;AAKA,4BAAaC,QAAb,EAAwB;AAAA;;AACvB,OAAKA,QAAL,GAAgBA,QAAhB;AACA,OAAKC,QAAL,GAAgBJ,QAAOG,QAAP,SAAhB;AACA;;AAED;;;;;;;;;yBAKQE,K,EAAQ;AACf,OAAMC,MAAMN,EAAGK,MAAME,aAAT,CAAZ;;AAEA;AACA,OAAK,CAAE,KAAKC,WAAL,CAAkBF,GAAlB,CAAP,EAAiC;AAChC;AACA;;AAED;AACA,QAAKG,SAAL;;AAEA,OAAMC,YAAYJ,IAAIK,EAAJ,CAAQ,UAAR,CAAlB;AACA,QAAKC,gCAAL,CAAuCN,GAAvC,EAA4CI,SAA5C;;AAEA;AACA,QAAKN,QAAL,CAAcS,IAAd,CAAoB,gCAApB,EAAuDC,EAAvD,CAA2D,CAA3D,EAA+DC,OAA/D,CAAwE,OAAxE;;AAEA;AACA,QAAKC,KAAL;AACA;;AAED;;;;;;;;;mDAMkCV,G,EAAsB;AAAA,OAAjBW,OAAiB,uEAAP,IAAO;;AACvDX,OAAIY,OAAJ,CAAa,WAAb,EAA2BC,IAA3B,CAAiC,UAAEC,KAAF,EAASC,OAAT,EAAsB;AACtD,QAAMC,QAAQtB,EAAGqB,OAAH,EAAaE,MAAb,CAAqB,IAArB,EAA4BV,IAA5B,CAAkC,wBAAlC,EAA6DC,EAA7D,CAAiE,CAAjE,CAAd;;AAEA,QAAKG,YAAYK,MAAME,IAAN,CAAY,SAAZ,CAAjB,EAA2C;AAC1C;AACA;;AAEDF,UAAME,IAAN,CAAY,SAAZ,EAAuBP,OAAvB,EAAiCF,OAAjC,CAA0C,QAA1C;AACA,IARD;AASA;;AAED;;;;;;;;;8BAMaT,G,EAAM;AAClB,UAAOA,IAAImB,OAAJ,CAAa,WAAb,EAA2BC,MAA3B,GAAoC,CAA3C;AACA;;AAED;;;;;;0BAGQ;AACP,QAAKtB,QAAL,CAAcuB,EAAd,CAAkB,4BAAlB,EAAgD,wBAAhD,EAA0E,KAAKC,MAAL,CAAYC,IAAZ,CAAkB,IAAlB,CAA1E;AACA;;AAED;;;;;;8BAGY;AACX,QAAKzB,QAAL,CAAc0B,GAAd,CAAmB,4BAAnB;AACA;;;;;;AAGF9B,EAAG,YAAM;AACR;AACA+B,4BAA2BC,mBAA3B,CAA+CC,OAA/C,CAAwD,UAAE9B,QAAF,EAAgB;AACvE,MAAI+B,UAAU,IAAIhC,iBAAJ,CAAuBC,QAAvB,CAAd;AACA+B,UAAQlB,KAAR;AACA,EAHD;AAIA,CAND","file":"parent-term-toggler.js","sourcesContent":["/* global _ParentTermTogglerSettings */\n\nconst { jQuery: $ } = window;\n\nclass ParentTermToggler {\n\t/**\n\t * Constructor.\n\t *\n\t * @param {string} taxonomy - The taxonomy name.\n\t */\n\tconstructor( taxonomy ) {\n\t\tthis.taxonomy = taxonomy;\n\t\tthis.$metabox = $( `#${taxonomy}div` );\n\t}\n\n\t/**\n\t * Toggle handler for change events.\n\t *\n\t * @param {object} event - Change event.\n\t */\n\ttoggle( event ) {\n\t\tconst $el = $( event.currentTarget );\n\n\t\t// Ignore changes to non-child terms.\n\t\tif ( ! this.termIsChild( $el ) ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Stop watching to avoid recursion.\n\t\tthis.stopWatch();\n\n\t\tconst isChecked = $el.is( ':checked' );\n\t\tthis.traverseParentTermsAndSetChecked( $el, isChecked );\n\n\t\t// Workaround for WordPress SEO to trigger primary term handling.\n\t\tthis.$metabox.find( 'input[type=\"checkbox\"]:checked' ).eq( 0 ).trigger( 'click' );\n\n\t\t// Start watching again.\n\t\tthis.watch();\n\t}\n\n\t/**\n\t * Gets all parent terms and (un)checks them.\n\t *\n\t * @param {object} $el - The jQuery element.\n\t * @param {boolean} checked - Whether the terms should be checked.\n\t */\n\ttraverseParentTermsAndSetChecked( $el, checked = true ) {\n\t\t$el.parents( '.children' ).each( ( index, element ) => {\n\t\t\tconst $term = $( element ).parent( 'li' ).find( 'input[type=\"checkbox\"]' ).eq( 0 );\n\n\t\t\tif ( checked === $term.prop( 'checked' ) ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t$term.prop( 'checked', checked ).trigger( 'change' );\n\t\t} );\n\t}\n\n\t/**\n\t * Whether a term has parent terms.\n\t *\n\t * @param {object} $el - The jQuery element.\n\t * @returns {boolean} True if a term has parent terms, false if not.\n\t */\n\ttermIsChild( $el ) {\n\t\treturn $el.closest( '.children' ).length > 0;\n\t}\n\n\t/**\n\t * Attaches an event handler for checkbox changes.\n\t */\n\twatch() {\n\t\tthis.$metabox.on( 'change.parent-term-toggler', 'input[type=\"checkbox\"]', this.toggle.bind( this ) )\n\t}\n\n\t/**\n\t * Removes the event handler for checkbox changes.\n\t */\n\tstopWatch() {\n\t\tthis.$metabox.off( 'change.parent-term-toggler' );\n\t}\n}\n\n$( () => {\n\t// Create a Toggler instance for each supported taxonomy.\n\t_ParentTermTogglerSettings.supportedTaxonomies.forEach( ( taxonomy ) => {\n\t\tlet toggler = new ParentTermToggler( taxonomy );\n\t\ttoggler.watch();\n\t} );\n} );\n"]}